window["lorisjs"]=window["lorisjs"]||{};window["lorisjs"]["data_release"]=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=5)}([function(module,exports){(function(){module.exports=window["React"]})()},function(module,exports,__webpack_require__){if(false){var throwOnDirectAccess,ReactIs}else{module.exports=__webpack_require__(3)()}},function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);var prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var Loader=function(_Component){_inherits(Loader,_Component);function Loader(props){_classCallCheck(this,Loader);return _possibleConstructorReturn(this,_getPrototypeOf(Loader).call(this,props))}_createClass(Loader,[{key:"render",value:function render(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"loader",style:{width:parseInt(this.props.size),height:parseInt(this.props.size)}})}}]);return Loader}(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);Loader.propTypes={size:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string};Loader.defaultProps={size:"120"};__webpack_exports__["a"]=Loader},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(4);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret===ReactPropTypesSecret){return}var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. "+"Use PropTypes.checkPropTypes() to call them. "+"Read more at http://fb.me/use-check-prop-types");err.name="Invariant Violation";throw err}shim.isRequired=shim;function getShim(){return shim}var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};ReactPropTypes.PropTypes=ReactPropTypes;return ReactPropTypes}},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";module.exports=ReactPropTypesSecret},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);var prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);var jsx_Loader__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var AddPermissionForm=function(_Component){_inherits(AddPermissionForm,_Component);function AddPermissionForm(props){var _this;_classCallCheck(this,AddPermissionForm);_this=_possibleConstructorReturn(this,_getPrototypeOf(AddPermissionForm).call(this,props));_this.state={data:{},fieldOptions:{},formData:{},hasError:{},errorMessage:{},isLoaded:false,loadedData:0};_this.setFormData=_this.setFormData.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this}_createClass(AddPermissionForm,[{key:"fetchData",value:function fetchData(){var _this2=this;return fetch(this.props.DataURL,{credentials:"same-origin"}).then((function(resp){return resp.json()})).then((function(data){return _this2.setState({data:data.Data,fieldOptions:data.fieldOptions})}))["catch"]((function(error){_this2.setState({error:true});console.error(error)}))}},{key:"componentDidMount",value:function componentDidMount(){var _this3=this;this.fetchData().then((function(){return _this3.setState({isLoaded:true})}))}},{key:"render",value:function render(){if(this.state.error!==undefined){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"alert alert-danger text-center"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("strong",null,this.state.error))}if(!this.state.isLoaded){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(jsx_Loader__WEBPACK_IMPORTED_MODULE_2__["a"],null)}return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(FormElement,{name:"addPermission",onSubmit:this.handleSubmit},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(SelectElement,{name:"userid",label:"User",options:this.state.fieldOptions.users,onUserInput:this.setFormData,ref:"userid",hasError:this.state.hasError.Username,errorMessage:this.state.errorMessage.Username,required:true,value:this.state.formData.userid}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h3",null,"Choose a specific file or an entire release below"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(SelectElement,{name:"data_release_id",label:"Data Release File",options:this.state.fieldOptions.filenames,onUserInput:this.setFormData,ref:"data_release_id",hasError:this.state.hasError.Filename,errorMessage:this.state.errorMessage.Filename,required:false,value:this.state.formData.data_release_id}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h4",{align:"center"},"OR"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(SelectElement,{name:"data_release_version",label:"Data Release Version",options:this.state.fieldOptions.versions,onUserInput:this.setFormData,ref:"data_release_version",hasError:this.state.hasError.Version,errorMessage:this.state.errorMessage.Version,required:false,value:this.state.formData.data_release_version}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ButtonElement,{label:"Add Permission"}))}},{key:"setFormData",value:function setFormData(formElement,value){var formData=this.state.formData;if(value===""){formData[formElement]=null}else{formData[formElement]=value}this.setState({formData})}},{key:"handleSubmit",value:function handleSubmit(){var _this4=this;var myFormData=this.state.formData;var formObj=new FormData;for(var key in myFormData){if(myFormData[key]!==""){formObj.append(key,myFormData[key])}}if(!this.isValidFormData()){return}fetch(this.props.action,{method:"post",body:formObj}).then((function(response){if(response.ok){swal({text:"Permission Update Success!",title:"",type:"success"},(function(){window.location.assign("/data_release")}));_this4.props.fetchData()}else{var msg=response.statusText?response.statusText:"Submission Error!";swal(msg,"","error");console.error(msg)}}))}},{key:"isValidFormData",value:function isValidFormData(){var isValid=true;var formData=this.state.formData;var errorMessage={Username:undefined,Filename:undefined,Version:undefined};var hasError={Username:false,Filename:false,Version:false};if(!formData.userid){errorMessage.Username="You must select a user!";hasError.Username=true;isValid=false}if(!formData.data_release_version&&!formData.data_release_id||formData.data_release_version&&formData.data_release_id){var msg="You must select a file OR a version to grant permission on!";errorMessage.Filename=msg;errorMessage.Version=msg;hasError.Filename=true;hasError.Version=true;isValid=false}this.setState({errorMessage,hasError});return isValid}}]);return AddPermissionForm}(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);AddPermissionForm.propTypes={DataURL:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string.isRequired,action:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string.isRequired};__webpack_exports__["default"]=AddPermissionForm}]);
//# sourceMappingURL=addPermissionForm.js.map